---

version: '2.0'

tools.dl_and_extract:
  input:
    - url
    - headers
    - params
    - save_path
    - extract_path

  tasks:
    download_archive:
    action: tools.archive.download
    input:
      url: <% $.url %>
      headers: <% $.headers %>
      params: <% $.params %>
      save_as: "<% $.save_as %>"
    publish:
      archive: <% task(download_archive).result.result.archive %>
    on-success:
      - extract_archive

  extract_archive:
    action: tools.archive.extract
    input:
      archive: <% $.archive %>
      directory: <% $.extract_path %>
      files: true
    publish:
      files: <% task(extract_archive).result.result.files %>
      archive: <% task(extract_archive).result.result.archive %>
